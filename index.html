<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Filings & Disclosures | Standard Dental Labs Inc.</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      color: #1e293b;
      background: transparent;
      margin: 20px;
    }
    h3 {
      margin: 0 0 10px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 6px 4px;
    }
    th {
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
      font-weight: 600;
    }
    tr {
      border-bottom: 1px solid #f1f5f9;
    }
    a {
      text-decoration: none;
      color: #0f172a;
      font-weight: 600;
    }
    a:hover {
      text-decoration: underline;
    }
    .date {
      white-space: nowrap;
      color: #64748b;
      font-size: 13px;
    }
    .desc {
      color: #475569;
      font-size: 14px;
    }
    .muted {
      color: #64748b;
      font-size: 13px;
    }
    code {
      background: #f3f4f6;
      padding: 2px 4px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <h3>Filings & Disclosures</h3>
  <div id="content" class="muted">Loading data…</div>

  <script>
  (async function(){
    const el = document.getElementById("content");

    // Always fetch the latest JSON (cache-buster added)
    const src = "disclosures.json?ts=" + Date.now();
    try {
      const res = await fetch(src, { cache: "no-store" });
      if (!res.ok) throw new Error("HTTP " + res.status);
      const filings = await res.json();

      if (!Array.isArray(filings) || !filings.length) {
        el.innerHTML = "<p>No filings or disclosures available.</p>";
        return;
      }

      // Sort newest first
      filings.sort((a,b)=>new Date(b.date)-new Date(a.date));

      // Render table
      el.classList.remove("muted");
      el.innerHTML = `
        <table>
          <thead>
            <tr><th>Title</th><th>Date</th><th>Description</th></tr>
          </thead>
          <tbody>
            ${filings.map(f => `
              <tr>
                <td><a href="${f.link}" target="_blank" rel="noopener noreferrer">${f.title}</a></td>
                <td class="date">${f.date ? new Date(f.date).toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'}) : ""}</td>
                <td class="desc">${f.description || ""}</td>
              </tr>`).join("")}
          </tbody>
        </table>
      `;

      // Debug info at bottom (optional)
      const dbg = document.createElement('div');
      dbg.style.cssText = "margin-top:8px;color:#64748b;font-size:12px";
      dbg.innerHTML = `Loaded <code>${src}</code> (${filings.length} records)`;
      el.parentNode.appendChild(dbg);

    } catch (e) {
      el.innerHTML = "<p>Couldn’t load filings/disclosures just now.</p>";
      console.error("Error fetching disclosures:", e);
    }
  })();
  </script>
</body>
</html>
